<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AutoAuthor</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß†</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        font-family: 'Inter', sans-serif;
        background-color: #f8f9fa;
        padding-top: 2rem;
        padding-bottom: 2rem;
      }
      .container {
        max-width: 760px;
      }
      .card-title {
        font-weight: 600;
      }
      .form-label {
        font-weight: 500;
      }
      input.form-control, select.form-select {
        border-radius: 0.5rem;
      }
      .btn-primary {
        border-radius: 0.5rem;
        transition: background-color 0.2s ease;
      }
      .btn-primary:hover {
        background-color: #0056b3;
      }
      .section-heading {
        font-size: 1rem;
        color: #6c757d;
        margin-top: 1.5rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="d-flex flex-column align-items-start pb-3 mb-4 border-bottom">
        <h1 class="display-5 fw-bold mb-1">AutoAuthor</h1>
        <blockquote class="blockquote mt-2 mb-0">
          <p class="mb-0">Your AI-powered writing assistant for fast, polished content.</p>
        </blockquote>
      </header>

      <div class="card shadow-sm p-4 mb-4">
        <h5 class="card-title mb-3">üìù Fill in Your Article Brief</h5>
        <form id="input-form">
          <div class="mb-3"><label for="topic" class="form-label">Topic</label><input type="text" class="form-control" id="topic" required></div>
          <div class="mb-3"><label for="target_audience" class="form-label">Target Audience</label><input type="text" class="form-control" id="target_audience" required></div>
          <div class="section-heading">Goal & Tone</div>
          <div class="row g-3 mb-3">
            <div class="col-md">
              <label for="content_goal" class="form-label">Content Goal</label>
              <select class="form-select" id="content_goal">
                <option>Educate</option>
                <option>Persuade</option>
                <option>Entertain</option>
                <option>Sell</option>
                <option>Inspire</option>
                <option>Awareness</option>
                <option>Engage</option>
              </select>
            </div>
            <div class="col-md">
              <label for="tonality" class="form-label">Tonality</label>
              <select class="form-select" id="tonality">
                <option>Conversational</option>
                <option>Professional</option>
                <option>Bold</option>
                <option>Casual</option>
                <option>Inspirational</option>
                <option>Empathetic</option>
              </select>
            </div>
          </div>

          <div class="section-heading">Content Details</div>
          <div class="mb-3"><label for="subtopic" class="form-label">Subtopic</label><input type="text" class="form-control" id="subtopic"></div>
          <div class="mb-3"><label for="draft_title" class="form-label">Draft Title</label><input type="text" class="form-control" id="draft_title" required></div>
          <div class="mb-3"><label for="keywords" class="form-label">Keywords (comma-separated)</label><input type="text" class="form-control" id="keywords"></div>

          <div class="section-heading">Structure Preferences</div>
          <div class="row g-3 mb-3">
            <div class="col-md">
              <label for="structure_style" class="form-label">Structure Style</label>
              <select class="form-select" id="structure_style">
                <option>Listicle</option>
                <option>Narrative</option>
                <option>Tutorial</option>
                <option>Review</option>
                <option>Opinion Piece</option>
                <option>Pros and Cons</option>
                <option>Case Study</option>
                <option>Step by Step Guide</option>
                <option>Essay</option>
                <option>How To Guide</option>
                <option>News Article</option>
                <option>Blog Post</option>
              </select>
            </div>
            <div class="col-md">
              <label for="article_length" class="form-label">Article Length</label>
              <select class="form-select" id="article_length">
                <option>short ~1000 words</option>
                <option selected>medium ~2000 words</option>
                <option>long ~3000 words</option>
              </select>
            </div>
          </div>

          <div class="form-check mb-4">
            <input class="form-check-input" type="checkbox" id="include_competitors" checked>
            <label class="form-check-label" for="include_competitors">Include Competitors?</label>
          </div>

          <button type="submit" class="btn btn-primary w-100" id="submit-button">üöÄ Generate Article</button>
        </form>
      </div>

      <div id="status-area" class="mt-4"></div>
    </div>

    <script>
      const form = document.getElementById('input-form');
      const submitButton = document.getElementById('submit-button');
      const statusArea = document.getElementById('status-area');

      form.addEventListener('submit', async (event) => {
        event.preventDefault();
        submitButton.disabled = true;
        submitButton.innerHTML = `
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          Generating...
        `;
        statusArea.innerHTML = '<div class="alert alert-info" role="alert">üîÑ Creating your article, please wait...</div>';

        const formData = {
          topic: document.getElementById('topic').value,
          target_audience: document.getElementById('target_audience').value,
          content_goal: document.getElementById('content_goal').value,
          tonality: document.getElementById('tonality').value,
          subtopic: document.getElementById('subtopic').value,
          draft_title: document.getElementById('draft_title').value,
          keywords: document.getElementById('keywords').value,
          structure_style: document.getElementById('structure_style').value,
          article_length: document.getElementById('article_length').value,
          include_competitors: document.getElementById('include_competitors').checked
        };

        try {
          const response = await fetch('http://127.0.0.1:8000/generate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData),
          });

          if (!response.ok) {
            const errorText = await response.text();
            throw new Error(`HTTP error! status: ${response.status} - ${errorText}`);
          }

          const blob = await response.blob();
          const fileURL = window.URL.createObjectURL(blob);

          const downloadLink = document.createElement("a");
          downloadLink.href = fileURL;
          downloadLink.download = `${formData.draft_title || "AutoAuthor_Article"}.docx`;
          downloadLink.className = "btn btn-success mt-3";
          downloadLink.textContent = "‚¨áÔ∏è Download Your Article";

          statusArea.innerHTML = `
            <div class="alert alert-success" role="alert">
              ‚úÖ Article generated successfully!
            </div>
          `;
          statusArea.appendChild(downloadLink);

        } catch (error) {
          console.error('Error submitting form:', error);
          statusArea.innerHTML = `
            <div class="alert alert-danger" role="alert">
              ‚ùå Failed to generate article. Error: ${error.message || 'Unknown error'}
            </div>
          `;
        } finally {
          submitButton.disabled = false;
          submitButton.innerHTML = 'Generate Article';
        }
      });
    </script>
  </body>
</html>
